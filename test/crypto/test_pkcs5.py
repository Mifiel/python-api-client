from testlib import BaseTestCase
from mifiel.crypto import PKCS5

class TestPKCS5(BaseTestCase):

  DECRYPTED_MESSAGE = """This memo represents a republication of PKCS #5 v2.0 from RSA
Laboratories' Public-Key Cryptography Standards (PKCS) series, and
change control is retained within the PKCS process.  The body of this
document, except for the security considerations section, is taken
directly from that specification.
This document provides recommendations for the implementation of
password-based cryptography, covering key derivation functions,
encryption schemes, message-authentication schemes, and ASN.1 syntax
identifying the techniques.
The recommendations are intended for general application within
computer and communications systems, and as such include a fair
amount of flexibility. They are particularly intended for the
protection of sensitive information such as private keys, as in PKCS
#8 [25]. It is expected that application standards and implementation
profiles based on these specifications may include additional
constraints.
Other cryptographic techniques based on passwords, such as password-
based key entity authentication and key establishment protocols
[4][5][26] are outside the scope of this document.  Guidelines for
the selection of passwords are also outside the scope.	"""

  FIXTURES = [
    {
      "data": "30820513305d06092a864886f70d01050d3050302f06092a864886f70d01050c302204104f490f59c379c56277617c3f7e0f31d4020207d0300a06082a864886f70d0209301d06096086480165030401160410d3c72bd7f042241673e8f997cad3ff9d048204b016c9854b38b810b5f4f9e04c6019eac21283c3a528fc485c2c8b5d88e7e5e323ab4c28d4b7597761792e66253980d16de2f938e31aa6a84d0b89f7e5bc2c5bad002e55321d22e8fe5f9f71becf793bf543f1b044c597f9ed5d124a36d7fe0c74b2979523226cb9a2974d293e52082a7788bc88914a2a8339d6baac9b86bb5107053618e171bbe4daf25e9056b594f0cedd3efecd176ab21dbe8b9f3dbd76cd7cf1283bf52055199d01ada3c9c31a5ba246b8626f9adac7804a9d9b0b9cbea6f84ac503ef37d4642fb453730b5d091781cf527b9238834a40fdda7a2a300b1469275a8d551a3c041a60b831362e4e60c207451e6e93dcd6de4eada0d4ac577b860c4d7c158770c8180e5ef50c77f95c191211d41f9c1b5d72f168ef52a8879fc43d5faf419406632f1125dbb997b3d29d98f4cd10641f605a9c2421d85ce1e7a6b8c9659cd01ec680de387a24ae147447ec842d2f7bf491b903c418975aecf3c97803ece4dc6e8db3ff1977e711555ccfae6b08a2b180674a2272b812c23c918a4b116e2d30343eb796adaa87613ebde865c755a9b33acbf74453cedfcd35e9305d29b281b9b8519951c42818b52512f0b026e5134e8eec1fc71d62d0f30d0dc52d2a7ca7b93a476efeee31f22ee3968ef7fc8bee056c9a3839027cf3ef8897477fe6eb41e9e7e0ec0f281dc9b9ff35339b351f70d5f16a1917bd474c3c5fc93521f66915aaa2629fecd6f810805d9591603cee4642cb45f1d6fba01f8f70a047cd33094b1e759936f85eef01b32e036294447d6c77bdfbe3bd6ec045b77a4a3c3b310d8cf84b226608119795eec49e0400735ed1c5139a47937488b15fc2d8a3a2df727e0ce1068f51466488469a178fdf808a7b733a86d369645c22971a549d8e7297e959af47ea9f1bb4f45701ddfe5e4ab8967e9b707eaca28adf79b9aeb443e6d9e3f852af6f901e7e92cec028bf66b4ee34c72a5046921043d911fd63bac6b1dba8cc1cb6256de4d37832d66b06cf36f1608c524f31d456cc6641364356186e1a3920e484f2e817c0df1a39a95e2e48f9c8a308efba12b8a80fa90ca6522aa141d8aacef2f9ddee8a434ff68fd11345e1d00ede888d536d1e4ff736f874e618945988d6efdb5d1089e3b774de0492a16bc0e9745549af6704dcf7219843c317ed5557f281840123d36d057951ca9e3c4eafa4fcd80650e51ea0e4598f91bbf58b2ad0fdd625142736dfe9ab98e1b733820a7962407095d2794051ee73a8e25e49efdd0438484bc5db0538f76d5a55cfa5993088cad5a4d3ae2519a1cd5f7cc96ef237d027c0dd6c228bb49cf5925ba25107b8dceb1cbd23e8c252ba36132b6eb5b7fea89a0b40709c746c044cb1fce44d4b7479fed96683e40ae689a8a08bb252799248304daa3d7dc2524c793815bd7710862b58e65cb7dd73e4d8b9682c0ce7f7e2ff2a3b927d63c893ad624d71a57e45b480971e1815284c104df73c5cd429bf68f3b520ad59f55c4473b1e395889ff853e3dd9b03fb9cb0062ba2dda57f5e1915a28e7781f65cbfda2cbfc659962fabb2c65fb888f2bd5033665777fcca087aaa5625fd220841563182c15bdc9111bc562d9e6042fb651d0922992c204c1ffeea57463fc07b355838479f48ea460bfb5d8d48718c1905536c0c15cc88e7c877eab4b1b1c4bea14a069870c2",
      "password": "TqPZq43V+l_izZRO=Xqn6WAoDP#5sizV",
    },
    {
      "data": "30820513305d06092a864886f70d01050d3050302f06092a864886f70d01050c30220410d1e220a659df91e13b9c2d798155f2cb020207d0300a06082a864886f70d0209301d060960864801650304010204100e9f6be2e9124d8912ce43c258945b90048204b03918187348aa6d6612baf1bdec32a2cfad50e1631f27a6af4f9d8a83cb0d2ba227c18693789b7ac0f2ad1ce03e92abb6ad947527e30f89b074e810e962d3f15b3b76ec32adbe7648257ff64277371df472ad1e7d231962ae39b5655a2b3015523f0e688f49cd12d7edb5974d1d9878090079e28772d4d046f11846882a7beb2199dcb69b498751128507f028e9e9829a40a0bf2b0452254262c9052c35a3f7c070a6e8feeff3ba13e6bfadfbf61c2c6e64988e2a16e08410d872d7999aeeda8d691eb3eb10ca3e7165b826db3911a5a015c43df621457bc2e57c9b939aa1a0290fe7ef924976ef7b7fe06adc664a1ae9a8b3c2acba9763a5aac373d99a33053cfab21517322e6eb21780da0503df074609cbcd57fba0d237efb30eeec8ae0896e302bf2c925429119620317c1078764e74bd4c557eec8782d1fd11d40de23e977a3aa59a92ae2dc308ca976d54f7e4e9db7a879fa143c1dcdc96a6e90ba31843a837a6ebeb3bb97ca8b9179634d7667a32904f580519e61a4cac1fa830e32b2980850052545a5716e191e01107a8040a987bd3c1bf4a1f8eed48b8764b4ea4818b61f0f037a30f8bfae1a7e20ed258872db1c627c94763fba787fcc1c647a29339149293b23b0eeabb4d4f67507fc9675b2fb91380cbb53d804b0e4aa4430de9e9921cf3eda27eed1ccc31305e8b91986f61f14253d2f33c8e585f1f547110f6b917e51cb566551ef9a26322b1a711c4582dd071c4c6ebd62a9648e8ea463cfecf80b45062bbd6af9a3c54f728c818b4b63a69e26279d3d4d979d4f33eb099e14876682d603a96b5b8e222205b85f24fded9cc1c359f7f44ca92cd11a3e6e0c8f19cc13aba9dcd66e4f642f01cea0d7917956f466f178306afa85eb2bd04d9b9e0538945a9c18b8735bfe5387ee6db243ad932da9a3acc6773623ce0a24bb93e890b791e79964914802584cf729dacb64993102c1698e2693cbe291f95d85aff9abc62e8bf46355bc0ed37b83de89e46cbc3d2bd4b86a4661e94d3407da3b19c7b90f373e31794a2e02bef898d5c5b06df0b185855e266820e52121f025a7f4c13dd501a99de6a687dff5b951a3b935c9a3fd4314ab0ccbf41e513a242e35075052fb4eea5f33fce7fd5dfa1e56f9a0fb05f947a5e3fbcedee16dd603ef1047b8e0cdd456f9084d0a926891bd05c891ec89aa21e810faa5f609fa2f600a2e5c0d9fdba9e3bd0ba880e764af3e2f4d1c721cc5eaae0215d78848496aca6ef8cb19bf0c930bd174eb16e2b2a5f2bff3d8611f1013f66426a78ed7ff0247267412d8617ce1a38cf50c85f091d00dde9319da331f88326bfa638a3c8f9931679ff30679d6571ef3e529fafe4a63dce4cb146f5d71a387bd137990287a1396820871da0edf9c435e6f1a75d37f4e2f6e1ae000a601197bfe7e72545ea8db577b49426740b642d50af86b6d5b2c19d596d40561de5436cccb10a6b4690692fd67984817c21ba23ab98d357564ebd987162078075b4111b7bee79fc6226b6ea3078a3ef3daf8f633931c20f3f43a176a4ad0937e0075f637e924d68a6300c046aadfe890dfafb58dbe7b06521406164455bb06193795797b260b0ef0b40cd770b8b636ad48a5ea32c0f2488516937fb3bc7e0d0d847445b0f5bd22d83a09cd39e17606251cd3c488927132bc6ad15b0c6ddc5e4",
      "password": "0C6o=-q2Zd0g5_2avoD&rZJEhcThTJwl",
    },
    {
      "data": "30820513305d06092a864886f70d01050d3050302f06092a864886f70d01050c30220410e6920e02b7467fb2dfc5a51598424de6020207d0300a06082a864886f70d0209301d060960864801650304012a0410c3fcf9cbf0b79d0c43cfaebe3ff6730b048204b0290e755d460ba549330f16ef89cf750ee9fb9c6bd3fb3ac3503693652d48365cb527909fb40be56adce1d4a3d68ad16d13215a7bef66c7bb4ea56640936f34263979be1084c46f042ae937aece6222c5b3bacc73f7bbc163f67d032c9728ffbb136bed6017d4f96977af279f42f5cbc795f7913c1002545c2940909605c310fe5b0744f06057ac6147695af5ceb0e67b63efb19ce18cd72ac167ec663161ff7fe23b1edac44024462a5f384f0180460c72e8b092e44dbfb6f8aa2e69bd399ff76a5c80d8405fb8a98769e27854a17c96904de8d0258c5375b3a279b0394ab23cd2729a9f9084705f874b8014045cba0a6708c9c379cb46e11a9575a82c2c2fb9dab913a4f7059ad9a84c950743ed8d0991f456eef0dba3c0639d178b70e301a588aaeb46c36a42423e1f1a8f35b9f872b9b10e9429f40f016243fa7319a403a550deeed822c464cc3a294933d8c35ccabc425d5655f8258586a80cd6b61242306b18c06fddf3fb3da680854bf0d9f58a08496a8ce4403a645c8147d86cc88f899e571df208f9bc421e5769788f868b1ca886c6656ffde4c3fe2fef4113ac854881a533ed9647645f2d00de8ed6e33d4414094f35faa23be7c3df7eaecfd3e1379795f4e213a901dc7d80d69a693d961c3db2feb15d01949670b78e627a67cb5383f20fa3b551f81fb6415036494fd292bf8006cbf5a4d19601c502ec1919ef8f05af02357fb87a68be4611f616684994e47b255a50b225c3a362e96a8eb6272b4cdfe6f463469a242ad42977d00e2118e28a65eb75ed67152cd9daf7151e2242cdd5861e10600405b02cb3cfa61ed54c6b1c3cadce6f01e9ef9f72250c508fc40a52a6283da249cefa6b770e4f1ff06f84c435d83eb09d82d33286b6e11a46f0eb835ef7ff16cab5a9eb176af03b49452978164901c189c929ff73daf1981e07105b4caa3568d9de3971812104ac732909370af625526b8639a49b6bbf50dc3f38c482a800849daf4702d44aff3324517d90b49a6a14aed44f46e7e81f706dd24485209c084c211b24b38a143c3ee6106e552c68761bc49d6866b20da95e51cfd0e9c8e97b85f2e76ef8b9fa422c12d2f4096e9d9445d303b680fa99dd98ad8fb4111d9ddd17ae716bf22d185ba8d1fa3faf145c47a695fa14614c030d74d01e158839cb48a4c76921c78b384d49eadbfa3b20345cc59cf345beeb330248a4668d06a52f99581e98dfac01bf56054107d5e62f94f9ef973bb263f054fa45e2a01a9d0e0181cddb096625f507a44b8cdca13dc746b79ca191fb54250c90b6737ddecff4388fec83b49c1bd1c8280f5924216fc84a0c7a4028f4b54c29892226ab5fb52b3c6855b949f3dbebae2267aecb66125bcd056dc9961a3139ce0ce61db03a2703beea7374fb759963b3a9d333958b454e3ab857d9b72cddfd91e40828ea8490b31af0fc21bf89bd68ce30c90dfea7b77cb1e0d8200dc541ee03d0a1a02809748d9db8d91ab91ba06a7ced35dd2cf7102b22c45e6352d9f287fdc3721240360dc9bef1ceb8c9ae66c029bf0faa2645095a9b56c5659e587d1f16a613bab4ba7daa1918e1f88bf39d84c6614ba89e64dc641cb6c72503add961b5a92af481c5c162c03a9e65bf1481d39a30b94173030bf04e85450b32ba4fabc97800bea180ce483da073ac9e1370a2b18195741d",
      "password": "vM54-xqPbEi46*NA0i9WAZ=uI82PS8Y.",
    },
  ]

  def test_pkcs5_decrypt(self):
    for test in self.FIXTURES:
      pkcs5 = PKCS5(test['data'])
      decrypted_data = pkcs5.decrypt_data(test['password'])
      assert decrypted_data == self.DECRYPTED_MESSAGE

  def test_pkcs5_load_from_dict(self):
    test = self.FIXTURES[0]
    seq = {
      'iv': 'd3c72bd7f042241673e8f997cad3ff9d',
      'salt': '4f490f59c379c56277617c3f7e0f31d4',
      'iterations': 2000,
      'key_size': '2.16.840.1.101.3.4.1.22',
      'cipher_data': '16c9854b38b810b5f4f9e04c6019eac21283c3a528fc485c2c8b5d88e7e5e323ab4c28d4b7597761792e66253980d16de2f938e31aa6a84d0b89f7e5bc2c5bad002e55321d22e8fe5f9f71becf793bf543f1b044c597f9ed5d124a36d7fe0c74b2979523226cb9a2974d293e52082a7788bc88914a2a8339d6baac9b86bb5107053618e171bbe4daf25e9056b594f0cedd3efecd176ab21dbe8b9f3dbd76cd7cf1283bf52055199d01ada3c9c31a5ba246b8626f9adac7804a9d9b0b9cbea6f84ac503ef37d4642fb453730b5d091781cf527b9238834a40fdda7a2a300b1469275a8d551a3c041a60b831362e4e60c207451e6e93dcd6de4eada0d4ac577b860c4d7c158770c8180e5ef50c77f95c191211d41f9c1b5d72f168ef52a8879fc43d5faf419406632f1125dbb997b3d29d98f4cd10641f605a9c2421d85ce1e7a6b8c9659cd01ec680de387a24ae147447ec842d2f7bf491b903c418975aecf3c97803ece4dc6e8db3ff1977e711555ccfae6b08a2b180674a2272b812c23c918a4b116e2d30343eb796adaa87613ebde865c755a9b33acbf74453cedfcd35e9305d29b281b9b8519951c42818b52512f0b026e5134e8eec1fc71d62d0f30d0dc52d2a7ca7b93a476efeee31f22ee3968ef7fc8bee056c9a3839027cf3ef8897477fe6eb41e9e7e0ec0f281dc9b9ff35339b351f70d5f16a1917bd474c3c5fc93521f66915aaa2629fecd6f810805d9591603cee4642cb45f1d6fba01f8f70a047cd33094b1e759936f85eef01b32e036294447d6c77bdfbe3bd6ec045b77a4a3c3b310d8cf84b226608119795eec49e0400735ed1c5139a47937488b15fc2d8a3a2df727e0ce1068f51466488469a178fdf808a7b733a86d369645c22971a549d8e7297e959af47ea9f1bb4f45701ddfe5e4ab8967e9b707eaca28adf79b9aeb443e6d9e3f852af6f901e7e92cec028bf66b4ee34c72a5046921043d911fd63bac6b1dba8cc1cb6256de4d37832d66b06cf36f1608c524f31d456cc6641364356186e1a3920e484f2e817c0df1a39a95e2e48f9c8a308efba12b8a80fa90ca6522aa141d8aacef2f9ddee8a434ff68fd11345e1d00ede888d536d1e4ff736f874e618945988d6efdb5d1089e3b774de0492a16bc0e9745549af6704dcf7219843c317ed5557f281840123d36d057951ca9e3c4eafa4fcd80650e51ea0e4598f91bbf58b2ad0fdd625142736dfe9ab98e1b733820a7962407095d2794051ee73a8e25e49efdd0438484bc5db0538f76d5a55cfa5993088cad5a4d3ae2519a1cd5f7cc96ef237d027c0dd6c228bb49cf5925ba25107b8dceb1cbd23e8c252ba36132b6eb5b7fea89a0b40709c746c044cb1fce44d4b7479fed96683e40ae689a8a08bb252799248304daa3d7dc2524c793815bd7710862b58e65cb7dd73e4d8b9682c0ce7f7e2ff2a3b927d63c893ad624d71a57e45b480971e1815284c104df73c5cd429bf68f3b520ad59f55c4473b1e395889ff853e3dd9b03fb9cb0062ba2dda57f5e1915a28e7781f65cbfda2cbfc659962fabb2c65fb888f2bd5033665777fcca087aaa5625fd220841563182c15bdc9111bc562d9e6042fb651d0922992c204c1ffeea57463fc07b355838479f48ea460bfb5d8d48718c1905536c0c15cc88e7c877eab4b1b1c4bea14a069870c2'
    }
    pkcs5 = PKCS5(seq)
    asn1_hex = pkcs5.dump_asn1()
    decrypted_data = pkcs5.decrypt_data(test['password'])
    assert asn1_hex == test['data']
    assert decrypted_data == self.DECRYPTED_MESSAGE


  def test_pkcs5_exceptions(self):
    # Not PKCS5
    with self.assertRaises(ValueError):
      PKCS5('5d06092a864886f70d01050d3050302f06092a864886f70d01050c302204104f490f59c379c56277617c3f7e0f31d4020207d0300a06082a864886f70d0209301d06096086480165030401160410d3c72bd7f042241673e8f997cad3ff9d048204b016c9854b38b810b5f4f9e04c6019eac21283c3a528fc485c2c8b5d88e7e5e323ab4c28d4b7597761792e66253980d16de2f938e31aa6a84d0b89f7e5bc2c5bad002e55321d22e8fe5f9f71becf793bf543f1b044c597f9ed5d124a36d7fe0c74b2979523226cb9a2974d293e52082a7788bc88914a2a8339d6baac9b86bb5107053618e171bbe4daf25e9056b594f0cedd3efecd176ab21dbe8b9f3dbd76cd7cf1283bf52055199d01ada3c9c31a5ba246b8626f9adac7804a9d9b0b9cbea6f84ac503ef37d4642fb453730b5d091781cf527b9238834a40fdda7a2a300b1469275a8d551a3c041a60b831362e4e60c207451e6e93dcd6de4eada0d4ac577b860c4d7c158770c8180e5ef50c77f95c191211d41f9c1b5d72f168ef52a8879fc43d5faf419406632f1125dbb997b3d29d98f4cd10641f605a9c2421d85ce1e7a6b8c9659cd01ec680de387a24ae147447ec842d2f7bf491b903c418975aecf3c97803ece4dc6e8db3ff1977e711555ccfae6b08a2b180674a2272b812c23c918a4b116e2d30343eb796adaa87613ebde865c755a9b33acbf74453cedfcd35e9305d29b281b9b8519951c42818b52512f0b026e5134e8eec1fc71d62d0f30d0dc52d2a7ca7b93a476efeee31f22ee3968ef7fc8bee056c9a3839027cf3ef8897477fe6eb41e9e7e0ec0f281dc9b9ff35339b351f70d5f16a1917bd474c3c5fc93521f66915aaa2629fecd6f810805d9591603cee4642cb45f1d6fba01f8f70a047cd33094b1e759936f85eef01b32e036294447d6c77bdfbe3bd6ec045b77a4a3c3b310d8cf84b226608119795eec49e0400735ed1c5139a47937488b15fc2d8a3a2df727e0ce1068f51466488469a178fdf808a7b733a86d369645c22971a549d8e7297e959af47ea9f1bb4f45701ddfe5e4ab8967e9b707eaca28adf79b9aeb443e6d9e3f852af6f901e7e92cec028bf66b4ee34c72a5046921043d911fd63bac6b1dba8cc1cb6256de4d37832d66b06cf36f1608c524f31d456cc6641364356186e1a3920e484f2e817c0df1a39a95e2e48f9c8a308efba12b8a80fa90ca6522aa141d8aacef2f9ddee8a434ff68fd11345e1d00ede888d536d1e4ff736f874e618945988d6efdb5d1089e3b774de0492a16bc0e9745549af6704dcf7219843c317ed5557f281840123d36d057951ca9e3c4eafa4fcd80650e51ea0e4598f91bbf58b2ad0fdd625142736dfe9ab98e1b733820a7962407095d2794051ee73a8e25e49efdd0438484bc5db0538f76d5a55cfa5993088cad5a4d3ae2519a1cd5f7cc96ef237d027c0dd6c228bb49cf5925ba25107b8dceb1cbd23e8c252ba36132b6eb5b7fea89a0b40709c746c044cb1fce44d4b7479fed96683e40ae689a8a08bb252799248304daa3d7dc2524c793815bd7710862b58e65cb7dd73e4d8b9682c0ce7f7e2ff2a3b927d63c893ad624d71a57e45b480971e1815284c104df73c5cd429bf68f3b520ad59f55c4473b1e395889ff853e3dd9b03fb9cb0062ba2dda57f5e1915a28e7781f65cbfda2cbfc659962fabb2c65fb888f2bd5033665777fcca087aaa5625fd220841563182c15bdc9111bc562d9e6042fb651d0922992c204c1ffeea57463fc07b355838479f48ea460bfb5d8d48718c1905536c0c15cc88e7c877eab4b1b1c4bea14a069870c2')

    # Algorithm not supported
    with self.assertRaises(ValueError):
      PKCS5('30820513305d06092a864886f70d01050d3050302f06092a864886f70d01050c30220410d1e220a659df91e13b9c2d798155f2cb020207d0300a06082a864886f70d0209301d0609608648016503040a0104100e9f6be2e9124d8912ce43c258945b90048204b03918187348aa6d6612baf1bdec32a2cfad50e1631f27a6af4f9d8a83cb0d2ba227c18693789b7ac0f2ad1ce03e92abb6ad947527e30f89b074e810e962d3f15b3b76ec32adbe7648257ff64277371df472ad1e7d231962ae39b5655a2b3015523f0e688f49cd12d7edb5974d1d9878090079e28772d4d046f11846882a7beb2199dcb69b498751128507f028e9e9829a40a0bf2b0452254262c9052c35a3f7c070a6e8feeff3ba13e6bfadfbf61c2c6e64988e2a16e08410d872d7999aeeda8d691eb3eb10ca3e7165b826db3911a5a015c43df621457bc2e57c9b939aa1a0290fe7ef924976ef7b7fe06adc664a1ae9a8b3c2acba9763a5aac373d99a33053cfab21517322e6eb21780da0503df074609cbcd57fba0d237efb30eeec8ae0896e302bf2c925429119620317c1078764e74bd4c557eec8782d1fd11d40de23e977a3aa59a92ae2dc308ca976d54f7e4e9db7a879fa143c1dcdc96a6e90ba31843a837a6ebeb3bb97ca8b9179634d7667a32904f580519e61a4cac1fa830e32b2980850052545a5716e191e01107a8040a987bd3c1bf4a1f8eed48b8764b4ea4818b61f0f037a30f8bfae1a7e20ed258872db1c627c94763fba787fcc1c647a29339149293b23b0eeabb4d4f67507fc9675b2fb91380cbb53d804b0e4aa4430de9e9921cf3eda27eed1ccc31305e8b91986f61f14253d2f33c8e585f1f547110f6b917e51cb566551ef9a26322b1a711c4582dd071c4c6ebd62a9648e8ea463cfecf80b45062bbd6af9a3c54f728c818b4b63a69e26279d3d4d979d4f33eb099e14876682d603a96b5b8e222205b85f24fded9cc1c359f7f44ca92cd11a3e6e0c8f19cc13aba9dcd66e4f642f01cea0d7917956f466f178306afa85eb2bd04d9b9e0538945a9c18b8735bfe5387ee6db243ad932da9a3acc6773623ce0a24bb93e890b791e79964914802584cf729dacb64993102c1698e2693cbe291f95d85aff9abc62e8bf46355bc0ed37b83de89e46cbc3d2bd4b86a4661e94d3407da3b19c7b90f373e31794a2e02bef898d5c5b06df0b185855e266820e52121f025a7f4c13dd501a99de6a687dff5b951a3b935c9a3fd4314ab0ccbf41e513a242e35075052fb4eea5f33fce7fd5dfa1e56f9a0fb05f947a5e3fbcedee16dd603ef1047b8e0cdd456f9084d0a926891bd05c891ec89aa21e810faa5f609fa2f600a2e5c0d9fdba9e3bd0ba880e764af3e2f4d1c721cc5eaae0215d78848496aca6ef8cb19bf0c930bd174eb16e2b2a5f2bff3d8611f1013f66426a78ed7ff0247267412d8617ce1a38cf50c85f091d00dde9319da331f88326bfa638a3c8f9931679ff30679d6571ef3e529fafe4a63dce4cb146f5d71a387bd137990287a1396820871da0edf9c435e6f1a75d37f4e2f6e1ae000a601197bfe7e72545ea8db577b49426740b642d50af86b6d5b2c19d596d40561de5436cccb10a6b4690692fd67984817c21ba23ab98d357564ebd987162078075b4111b7bee79fc6226b6ea3078a3ef3daf8f633931c20f3f43a176a4ad0937e0075f637e924d68a6300c046aadfe890dfafb58dbe7b06521406164455bb06193795797b260b0ef0b40cd770b8b636ad48a5ea32c0f2488516937fb3bc7e0d0d847445b0f5bd22d83a09cd39e17606251cd3c488927132bc6ad15b0c6ddc5e4')

    # Digest not supported
    with self.assertRaises(ValueError):
      PKCS5('30820513305d06092a864886f70d01050d3050302f06092a864886f70d01050c30220410e6920e02b7467fb2dfc5a51598424de6020207d0300a06082a864886f70d0208301d060960864801650304012a0410c3fcf9cbf0b79d0c43cfaebe3ff6730b048204b0290e755d460ba549330f16ef89cf750ee9fb9c6bd3fb3ac3503693652d48365cb527909fb40be56adce1d4a3d68ad16d13215a7bef66c7bb4ea56640936f34263979be1084c46f042ae937aece6222c5b3bacc73f7bbc163f67d032c9728ffbb136bed6017d4f96977af279f42f5cbc795f7913c1002545c2940909605c310fe5b0744f06057ac6147695af5ceb0e67b63efb19ce18cd72ac167ec663161ff7fe23b1edac44024462a5f384f0180460c72e8b092e44dbfb6f8aa2e69bd399ff76a5c80d8405fb8a98769e27854a17c96904de8d0258c5375b3a279b0394ab23cd2729a9f9084705f874b8014045cba0a6708c9c379cb46e11a9575a82c2c2fb9dab913a4f7059ad9a84c950743ed8d0991f456eef0dba3c0639d178b70e301a588aaeb46c36a42423e1f1a8f35b9f872b9b10e9429f40f016243fa7319a403a550deeed822c464cc3a294933d8c35ccabc425d5655f8258586a80cd6b61242306b18c06fddf3fb3da680854bf0d9f58a08496a8ce4403a645c8147d86cc88f899e571df208f9bc421e5769788f868b1ca886c6656ffde4c3fe2fef4113ac854881a533ed9647645f2d00de8ed6e33d4414094f35faa23be7c3df7eaecfd3e1379795f4e213a901dc7d80d69a693d961c3db2feb15d01949670b78e627a67cb5383f20fa3b551f81fb6415036494fd292bf8006cbf5a4d19601c502ec1919ef8f05af02357fb87a68be4611f616684994e47b255a50b225c3a362e96a8eb6272b4cdfe6f463469a242ad42977d00e2118e28a65eb75ed67152cd9daf7151e2242cdd5861e10600405b02cb3cfa61ed54c6b1c3cadce6f01e9ef9f72250c508fc40a52a6283da249cefa6b770e4f1ff06f84c435d83eb09d82d33286b6e11a46f0eb835ef7ff16cab5a9eb176af03b49452978164901c189c929ff73daf1981e07105b4caa3568d9de3971812104ac732909370af625526b8639a49b6bbf50dc3f38c482a800849daf4702d44aff3324517d90b49a6a14aed44f46e7e81f706dd24485209c084c211b24b38a143c3ee6106e552c68761bc49d6866b20da95e51cfd0e9c8e97b85f2e76ef8b9fa422c12d2f4096e9d9445d303b680fa99dd98ad8fb4111d9ddd17ae716bf22d185ba8d1fa3faf145c47a695fa14614c030d74d01e158839cb48a4c76921c78b384d49eadbfa3b20345cc59cf345beeb330248a4668d06a52f99581e98dfac01bf56054107d5e62f94f9ef973bb263f054fa45e2a01a9d0e0181cddb096625f507a44b8cdca13dc746b79ca191fb54250c90b6737ddecff4388fec83b49c1bd1c8280f5924216fc84a0c7a4028f4b54c29892226ab5fb52b3c6855b949f3dbebae2267aecb66125bcd056dc9961a3139ce0ce61db03a2703beea7374fb759963b3a9d333958b454e3ab857d9b72cddfd91e40828ea8490b31af0fc21bf89bd68ce30c90dfea7b77cb1e0d8200dc541ee03d0a1a02809748d9db8d91ab91ba06a7ced35dd2cf7102b22c45e6352d9f287fdc3721240360dc9bef1ceb8c9ae66c029bf0faa2645095a9b56c5659e587d1f16a613bab4ba7daa1918e1f88bf39d84c6614ba89e64dc641cb6c72503add961b5a92af481c5c162c03a9e65bf1481d39a30b94173030bf04e85450b32ba4fabc97800bea180ce483da073ac9e1370a2b18195741d')
